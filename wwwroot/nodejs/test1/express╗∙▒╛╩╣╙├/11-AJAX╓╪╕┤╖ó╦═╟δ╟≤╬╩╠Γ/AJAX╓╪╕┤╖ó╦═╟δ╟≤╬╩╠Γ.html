<!--在发起第二次相同的Ajax请求之后，取消第一次请求-->
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>AJAX 重复请求问题</title>
	<style>
		#result{
			width:200px;
			height:100px;
			border:solid 1px #09b;
		}
	</style>
</head>
<body>
	<button>点击发送Ajax请求</button>
	<dir id="result"></dir>
	
	<script>
		const btn = document.getElementsByTagName('button')[0];
		const result = document.getElementById('result');
		let xhr = null;
		//创建isSending用来标识变量，判断是否正在发送Ajax请求
		let isSending = false;
		
		btn.onclick = function(){
			if(isSending){ xhr.abort(); } //isSending为true，则取消之前的发送，并创建一个新的发送。
			xhr = new XMLHttpRequest();
			isSending = true;
			xhr.open('get','http://127.0.0.1:8000/server/yanshi');
			xhr.send();
			xhr.onreadystatechange = function(){
				if(xhr.readyState === 4){
					isSending = false;	//发送结束标识为false
					if(xhr.status >=200 && xhr.status < 300){
						result.innerHTML = xhr.response;
					}else{
						//alert("请求超时");
					}
				}
			}
			
		}
	</script>
</body>
</html>